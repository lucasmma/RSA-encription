#!usr/bin
import RSAencryption as RSAenc
import base64
from hashlib import sha3_256

import SHA3

def main():

    msg = str(input("Enter a message to cipher: "))

    # e, d, n = RSAenc.generateKeys()

    e = 179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137217
    d = 15474974334797061277515141221414908066321239048969105409306668546136570104633157548606984513843497419315255608019486887398267608644207551797983700295037332054256607968500726162583992592712037099177508560525639279930686229711999738588157517537986017637077711787182415656170815383466189186661879034532974172675325752275759576146608669361570081843993123901578094684141723950212195800198472064674247108558952618473241239760654868912307316262242867016605203282283244114819702861034336498633670665353066927906813609209811315508161902705659671881532513838604951737199606293759892551261686356437388334022455580945352460673769
    n = 25972322025121663060045831552125515264422057554590827356539077772102078012039223935495696183196942879688234839002290078367592706934127249957825529802188974510121174988428697320757270040619336162410216193904481970571628135410654198142212498751212191819388223511883245018147202856037370358220663141789969867952323474800861961512710297041243972914159409411497571749731529383111887796808393309296530287872687255605664344407153890564889072392621420574182671318773959868664286728000311110935996559565970134678683889675626197793157498442426390800498912852603004453537502561647716270497654929218205411182748213390885614461011


    print("ENC: \t", e)
    print("DEC: \t", d)
    print("N: \t", n)
    
    hash = sha3_256(msg.encode()).digest()

    print("SHA3: \t", hash.hex())

    msgcifrada = RSAenc.encrypt(hash, e, n)
    
    print("Mensagem cifrada : \t", msgcifrada)

    msgdecifrada = RSAenc.decrypt(msgcifrada, d, n)

    print("Mensagem decifrada : \t", msgdecifrada.hex())

    if hash == msgdecifrada:
        print("Hash Ã© valido")

if __name__ == '__main__':
    main()